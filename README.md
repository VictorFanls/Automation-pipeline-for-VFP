# Automation-pipeline-for-VFP in ONEheart(Airbus)
automation pipeline for VFP in ONEheart

Description:
-------------
This Python script automates the execution of Viscous Full Potential (VFP) simulations by calling `.bat` batch files 
based on the flow condition `.dat` files found in a specific folder. (The flow files are generated by default in the correct directory.)

Key Features:
-------------
- Extracts angle of attack (AoA) from `.dat` filenames in the 'Flow_Conditions' directory.
- Sorts the AoA values in ascending order.
- Runs the first case without continuation using `runvfphe_v4.bat`.
- Runs all remaining cases as continuation runs using `runvfphe_v4.bat`.

File Structure:
---------------
Assume the following directory layout:

    project_directory/
    ├── All Python scripts. (This includes: VFP_Full_Process.py, VFP_Run_Main_V3.py, VFP_Data_Extraction(Utils & Main), VFP_File_Generation(Utils & Main).
    ├── runvfphe_v4.bat
    └── Flow_Conditions/
        ├── M085Re19p8ma-2p00.dat
        ├── M085Re19p8ma-1p50.dat
        └── ...
    ├── M085Re19p8ma-2p00.dat
    ├── M085Re19p8ma-1p50.dat
    └── ...

Instructions:
-------------

1. Place all `.dat` files in the `Flow_Conditions/` subfolder. (This will be done by the program by default.)
   These should follow the naming pattern: M<digits>Re<digits>p<digits>ma[+/-]<AoA>p<digits>.dat (e.g., M085Re19p8ma-2p00.dat)
   -> All non-negative AoA flow files must have a '+' sign in the name.

2. Ensure that `runvfphe_v4.bat` is in the same directory as the main Python script.

3. Run the script from a terminal or IDE. It will prompt you to enter the initial flow file(that is, the flow run you wish to run without a continuation run), the MAP, and the GEO base name, for example:
       Enter the original .dat filename: M085Re19p8ma-1p00.dat
       Enter the MAP base name (e.g., Saabnew): Saab_new
       Enter the GEO base name (e.g., Saabnew): Saab_new

4. Make sure there are no additional ".dat" files inside the folder other than the flow file you need to run. Do NOT try to run multiple flow conditions in the same folder as the program will break.


Notes:
------
- All `.dat` files must be in `Flow_Conditions/`. AND the working directory(This will be done by default).
- The batch files assume that the input `.dat` file (from the third argument) exists in the current working directory.
  If this is not the case, copy or link the `.dat` file into the working directory before executing the batch file.
- If any filenames contain spaces, wrap them in double quotes when modifying or extending the script.

Troubleshooting:
----------------
- If the batch file fails, ensure that:
  a. The `.dat` file exists in the correct location.
  b. The filenames are passed correctly.
  c. You are not missing quotes around filenames with spaces.
- If the `.bat` file needs a specific working directory, you may need to `os.chdir(...)` into that directory from Python.

User Input Format Guide
========================

When prompted to enter input (e.g., the MAP and GEO base name), follow these conventions exactly to ensure the script works correctly:

1. **Flow File Generation**

   - Enter the full name of the original flow file, including the extension.
   - Make sure that the original file exists in the same folder as the Python scripts.
   - Do NOT include any directory paths. The script assumes these files are in the current directory.
   - After file generation, there would be 2 versions of each flow file(one in the "Flow_Conditions" folder and one in the scripts directory)


2. **MAP and GEO Base Name**
   - This is a base string from both the MAP and GEO files used in the batch simulation.
   - Example: If your files are named `Saab_new.map` and `Saab_new.geo`, then you should enter:

     ```
     Saab_new
     Saab_new

   - Do NOT include file extensions like `.map` or `.geo`.
   - Do NOT include any directory paths. The script assumes these files are in the current directory.

3. **Flow Condition Files**
   - These must be `.dat` files stored inside the `Flow_Conditions/` folder.
   - They should follow the naming convention:

     ```
     M<digits>Re<digits>p<digits>ma<AoA>.dat
     ```

     Examples:
     - `M085Re19p8ma-2p00.dat`
     - `M085Re19p8ma+0p00.dat`
     - `M085Re19p8ma+1p00.dat`

   - The script extracts the AoA automatically from the filename and uses the **base name without extension** when calling the batch files.
   - The number of AoAs needed, as well as the increment step, will be inputs for the "VFP_File_Generation_Utils.py"

4. **Important Notes**
   - Do not move `.dat` files into the main script directory unless you explicitly change the script to look there.
   - If modifying the script or batch files, ensure that paths are correctly handled and filenames are properly quoted if they contain spaces.
   - Missing wavedrag or forces files will create errors in the code. Do not delete any files until the code is complete.
